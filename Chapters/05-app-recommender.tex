\chapter{App-Recommender} \label{chapter:app-rec}

Este capítulo apresenta o \emph{AppRecommender} como proposta de um
recomendador de aplicativos GNU/Linux.

\section{Escolha da plataforma}

A distribuição escolhida como base para o desenvolvimento deste trabalho
foi o Debian GNU/Linux. No entanto, a independência de plataforma foi sempre
levada em consideração na fase de desenvolvimento, com o intuito de que os
resultados sejam facilmente adaptáveis para outros contextos. As seguir estão
descritos os critérios que pautaram esta escolha.

\begin{enumerate}

\item \textbf{Esquema consistente de distribuição de aplicativos.} O
  gerenciamento de pacotes em sistemas Debian GNU/Linux é realizado através do
  \textit{APT}, cujas funcionalidades foram apresentadas na seção
  \ref{sec:apt}. Apesar de atualmente outras distribuições oferecerem
  ferramentas similares, o \textit{APT} é certamente uma das mais maduras,
  sendo inclusive apontada por alguns desenvolvedores como razão da explosão
  no surgimento de distribuições derivadas do Debian (herdeiras do esquema).

\vspace{0.3cm}
\item \textbf{Disponibilidade de dados estatísticos.} O \textit{Popcon
  (Popularity Contest)}\footnote{\url{http://popcon.debian.org}} é o concurso
  de popularidade entre pacotes. Os usuários que aceitam participar do concurso
  enviam periodicamente a sua lista de pacotes instalados no sistema, que são
  armazenados no servidor do Popcon. Diariamente as listas recebidas são
  processadas e dados estatísticos acerca do uso dos pacotes são gerados e
  disponibilizados no website do projeto.

\vspace{0.3cm}
\item \textbf{Possibilidade de integração dos resultados do trabalho.} Segundo
  o \textit{contrato social
  Debian}\footnote{\url{http://www.debian.org/social_contract.pt.html}},
  o desenvolvimento do projeto é guiado pelas necessidades dos usuários e da
  comunidade. Portanto, as iniciativas de colaboradores individuais, sejam eles
  desenvolvedores oficiais ou não, serão igualmente consideradas e passarão a
  fazer parte da distribuição se seguirem os princípios do projeto e forem
  considerados úteis para a comunidade.

\vspace{0.3cm}
\item \textbf{Popularidade.} O Debian é um projeto de destaque no ecossistema
  do software livre. Desde o lançamento da primeira versão de sua distribuição,
  em 1993, o projeto cresceu bastante em termos de componentes de software
  (atualmente provê mais de 25.000 pacotes), colaboradores e usuários. A
  \textit{Distrowatch}, que tem 323 distribuições ativas em sua base de
  dados\footnote{Consulta realizada em 24 de janeiro de 2011.}, classifica o
  Debian GNU/Linux entre as 10 distribuições mais
  populares\footnote{\url{http://distrowatch.com/dwres.php?resource=major}}.
  O Debian aparece na quinta posição em suas estatísticas de páginas
  visitadas\footnote{\url{http://distrowatch.com/stats.php?section=popularity}}.
  Já o \textit{Linux Counter\footnote{\url{http://counter.li.org/reports/machines.php}}} apresenta o Debian como a segunda distribuição mais popular entre as
  máquinas cadastradas que rodam o kernel Linux ($16\%$), ficando atrás apenas
  do Ubuntu\footnote{\url{http://www.ubuntu.com/community/ubuntu-and-debian}}
  ($24\%$), que é uma distribuição derivada do Debian. Nas pesquisas da
  \textit{W$^{\textrm{3}}$Techs} sobre tecnologias para serviços
  web\footnote{\url{http://w3techs.com/technologies/history_details/os-linux}},
  o Debian aparece em segundo lugar, estando presente em $27\%$ dos servidores.
  Na primeira posição está o CentOS com $31\%$.

\end{enumerate}

De maneira geral, quando o projeto Debian é mencionado trata-se não somente do
sistema operacional, mas de toda a infra-estrutura de desenvolvimento e
coordenação que dá suporte ao trabalho de cerca de 900 desenvolvedores
oficiais\footnote{\url{http://www.perrier.eu.org/weblog/2010/08/07\#devel-countries-2010}},
além de outros milhares de colaboradores ao redor do globo. O trabalho é
realizado de forma colaborativa, afinado pelo objetivo comum de produzir e
disponibilizar livremente um sistema operacional de qualidade para seus
usuários \cite{Jackson:98}. A interação entre os desenvolvedores acontece
majoritariamente através da Internet, por meio de canais IRC e listas de
discussão públicas. Não existe uma entidade formal ou qualquer tipo de
organização que concentre, coordene ou defina as atividades do projeto. O que
observa-se é um modelo de governança consolidado que emergiu naturalmente ao
longo de sua história \cite{Ferraro:07}.

\section{Caracterização do problema}

Este trabalho tem como proposta principal o desenvolvimento de soluções para o
problema da recomendação no contexto de componentes de software, em especial no
âmbito de distribuições GNU/Linux. Neste cenário, os aplicativos são modelados
como itens e os usuários da distribuição como clientes do recomendador.

Embora já faça parte da pauta de discussões entre desenvolvedores um esquema de
pontuação de pacotes como medida de avaliação pessoal e comentários dos
usuários, não há previsão para tal solução de fato ser implementada
\cite{Freedesktop:11}. No entanto, a presença de um componente no sistema do
usuário pode ser considerado como indicativo de relevância. A pontuação neste
caso é binária -- um item pode ser relevante ou irrelevante -- e o processo de
recomendação é caracterizado da seguinte maneira: dada a lista de pacotes
instalados no sistema de determinado usuário (como representação de sua
identidade), o recomendador deve retornar uma lista de pacotes sugeridos, que
representam aplicativos de potencial interesse para tal usuário. Desta forma, a
ação principal do sistema será \textit{encontrar itens relevantes} (ver seção
\ref{sec:acoes}).

As recomendações devem ser produzidas a partir do comportamento do usuário.
Neste trabalho não serão consideradas por exemplo informações registradas no
BTS, PTS ou em listas de discussão. A computação será principalmente realizada
com base em dados do \textit{Popcon} (listas de pacotes de milhares de sistemas
em produção), e do \textit{Debtags} e \textit{UDD} como fonte de metadados
sobre os pacotes (atributos). A utilização de dados demográficos também está
sendo considerada. Por exemplo, a declaração explícita por parte do usuário de
que não tem interesse por determinado nicho de aplicativos eliminaria de
antemão uma série de pacotes que a princípio seriam considerados. De certa
forma, o uso de perfis pode possibilitar a realização de uma seleção de
atributos específica para cada usuário.

\subsection{Considerações acerca da dependência entre pacotes}
%FIXME [Investigar a utilidade do Debtags pra selecao de atributos]

Uma característica peculiar da recomendação neste contexto é que,
diferentemente de outros domínios nos quais os itens não se relacionam entre
si, os componentes de software objeto desta pesquisa podem declarar requisitos
em seu conteúdo (dependência, sugestão, recomendação, conflito, substituição,
quebra etc). Requisitos positivos representam relações de dependência,
enquanto os negativos caracterizam relações de conflito entre os pacotes
 \cite{Cosmo:09}. Por exemplo, se um componente $a$ depende de $b$, significa
que $b$ deve ser instalado no sistema para que $a$ funcione como previsto. Por
outro lado, se $a$ conflita com $c$, a instalação de ambos os aplicativos pode
provocar um comportamento anômalo ou até comprometer o funcionamento de todo o
sistema.

As relações entre componentes também devem ser consideradas pelo recomendador
de pacotes. Intuitivamente, numa mesma recomendação não faz sentido sugerir
pacotes dependentes, visto que ao aceitar a recomendação de um determinado
componente e prosseguir com a instalação do mesmo, o usuário já está
implicitamente aceitando a recomendação de todas as suas dependências. No
entanto, um recomendação que contenha por exemplo os pacotes $a$ e $b$, dado
que $a$ depende de $b$, se $a$ obtiver uma alta estimativa de relevância em
virtude de seus atributos (por estratégias baseadas em conteúdo), esta
recomendação não deve ser descartada. No caso de pacotes ``guarda-chuva'',
que possuem muitas dependências, é comum que o usuário se interesse apenas
por uma de suas dependências.

No que diz respeito à mineração de conhecimento a partir de uma base de dados,
um ponto importante a considerar é que o fato de pacotes com alguma relação de
dependência estarem presentes concomitantemente em grande parte dos sistemas
não é uma coincidência, e sim uma consequência direta da dependência. Por outro
lado, teriam grande valor as associações que relacionassem componentes que por
definição não apresentam relação alguma. Neste cenário, novos graus de
relacionamento poderiam ser estabelecidos, baseados não na dependência mas na
colaboração entre os componentes.

\subsection{Considerações acerca da necessidade dos usuários}

Um sistema de recomendação de pacotes tem como principal função sugerir novos
pacotes a partir de escolhas anteriores do usuário, assumindo que os
recomendados são os que melhor satisfazem às suas necessidades. Todavia, o
conceito de \textit{pacote} já é uma abstração, e nem sempre a necessidade de um
usuário pode ser mapeada diretamente na instalação de pacotes específicos.

A necessidade do usuário diz respeito às funcionalidades que os aplicativos
oferecem. Visto que aplicativos diferentes podem executar a mesma função,
(resguardadas as devidas peculiaridades), o mais apropriado seria representar
a necessidade ou desejo do usuário (analogamente, sua identidade) como um
conjunto de funcionalidades, em vez de um conjunto de pacotes específicos.

Algumas funcionalidades de pacotes podem ser extraídas a partir da lista de
pacotes virtuais\footnote{http://www.debian.org/doc/packaging-manuals/virtual-package-names-list.txt}. Este conceito foi criado especialmente para situações
em que diversos pacotes diferentes oferecem um conjunto de funcionalidades
semelhantes. Pacotes virtuais não existem fisicamente no repositório, são
apenas mencionados no campo \textit{Provides} da definição de outros pacotes
(``concretos''). Desta forma, quando uma dependência se refere a um pacote
virtual, ela pode ser satisfeita com a instalação de qualquer pacote que provê
o mesmo.

No entanto, a lista de pacotes virtuais é controlada e relativamente pequena.
Acredita-se porém que uma análise detalhada da base do \textit{Debtags} pode
revelar novas funcionalidades como abstrações de conjuntos de \textit{tags},
que poderão eventualmente ser utilizadas para refinar o cálculo das
recomendações.

\section{Coleta de dados}

Os dados estatísticos disponíveis publicamente no site do \textit{Popcon} não
preservam os relacionamentos usuário-item, essenciais para a utilização de
estratégias colaborativas. Por questões relativas à
privacidade\footnote{\url{http://popcon.debian.org/FAQ}}, as listas de pacotes
originais submetidas pelos usuários não são publicadas, apenas as estatísticas
geradas e um resumo de todas as submissões são disponibilizados diariamente.
No entanto, este trabalho é desenvolvido com o apoio de desenvolvedores
oficiais Debian, o que possibilitará o acesso aos dados necessários.

No entanto, as bases de dados do \textit{UDD} e do \textit{Debtags} são
públicas, não havendo impedimento algum para acessá-las. Por fim, perfis de
usuários podem ser formados com base no preenchimento facultativo de um
formulário antes da utilização do recomendador.

\section{Seleção de atributos}

A seleção de atributos geralmente proporciona ganhos na eficiência e qualidade
das recomendações, na medida em que diminui o ruído e o montante de dados a
ser considerado. Além da aplicação de métodos clássicos de seleção,
apresentados na seção \ref{sec:selecao_atributos}, existem peculiaridades do
domínio de componentes de software que podem ampliar tais benefícios se
consideradas.

Seja qual for o sistema operacional ou distribuição GNU/Linux, existe um
conjunto de componentes que fazem parte da instalação padrão, selecionados
pela equipe de desenvolvimento. Considerando que os usuários do recomendador
utilizam um sistema funcional, existem dois casos a considerar: (1) todo o
conjunto de componentes da instalação padrão está instalado no sistema e (2)
alguns componentes não estão presentes porque foram propositalmente removidos
pelo usuário. Em ambos os casos a recomendação de tais pacotes certamente não
interessaria ao usuário, portanto acredita-se que todos eles possam ser
desconsiderados sem prejuízo para a recomendação.

Os dados coletados pelo \textit{Popcon} também possuem informações temporais.
A data de instalação do pacote no sistema é obtida através do atributo
\textit{ctime} do arquivo, que indica a data de sua criação no sistema de
arquivos, enquanto a data de última utilização é indicada pelo \textit{atime},
com a data do último acesso. Apesar destes dados não serem seguramente
confiáveis\footnote{\url{http://popcon.debian.org/README}}, a possibilidade
de uso dos mesmo será investigada. Seria interessante, por exemplo, atribuir
pesos diferentes para pacotes que são usados com muita frequência pelo usuário
em detrimento de outros que foram acessados pela última vez logo após serem
instalados.

\section{Estratégias implementadas}

Optou-se por utilizar técnicas de busca como base das soluções, mesmo para
estratégias herdadas de classificação, dado que a construção prévia de índices
de busca otimiza o cálculo de dissimilaridades entre itens.

Ao final desta seção, na tabela \ref{}, será apresentado o conjunto de
identificadores das diferentes estratégias adotadas, que a seguir são
apresentadas em detalhes.
 
\subsection{Repositórios de dados}

Os repositórios utilizados na implementação estão descritos na tabela abaixo.
A tabela \ref{tab:repositorios_dados} apresenta a fonte de dados de cada índice
de busca e faz um paralelo com uma coleção de documentos de texto compostos por
termos ou palavras-chave, o que em cada cenário representa um documento e o que
representam termos. O modelo de espaço vetorial em cada caso pode representado
por uma matriz de documentos por termos.

\begin{table}[h!]
  \caption{Descrição de repositórios de dados utilizados}
  \label{tab:repositorios_dados}
  \centering
  \newcommand\T{\rule{0pt}{2.8ex}}
  \newcommand\B{\rule[-1.8ex]{0pt}{0pt}}
  \begin{tabularx}{15cm}{| c | l | l | X |}
    \hline
    \textbf{Identificador} & \textbf{Fonte dos dados} & \textbf{Documento}
                                                      & \textbf{Termos}  \T\B\\
    \hline
    axi & Pacote apt-xapian-index & pacote Debian & conjunto de metadados sobre
                                                    o pacote (descrição,
                                                    dependências etc) \T\B\\
    \hline
    txi & Base de Debtags & pacote Debian & tags \T\B\\
    \hline
    pxi & Popcon & submissão do popcon & pacotes instalados  \T\B\\
    \hline
  \end{tabularx}
\end{table}

\subsection{Baseadas em conteúdo}

As técnicas baseadas em conteúdo foram implementadas com o suporte da
biblioteca Xapian, que utiliza a técnica \textit{BM25}, descrita na seção
\ref{sec:bm25}. As recomendações podem ser produzidas com base na descrição dos
pacotes já instalados pelo usuário ou por suas tags.

%\hspace{1cm}A caracterização dos pacotes através de \textit{Debtags} é
% essencial para a implementação de estratégias baseadas em conteúdo.

\subsection{Colaborativas}

O \textit{Popcon} é a fonte de dados disponível atualmente para soluções
colaborativas de recomendação. Neste contexto, listas de pacotes representam a
identidade do usuário, que receberá recomendações com base no que outros
usuários com interesses semelhantes aos dele têm instalado em seus sistemas e
ele não tem.

Como estratégias colaborativas, foram implementadas soluções baseadas nas
técnicas \textit{K-NN} e agrupamento por \textit{k-medoid}. A composição da
vizinhança do \textit{K-NN}, no entanto foi realizada a partir de uma busca no
repositório \textit{pxi}. Já para a solução de agrupamento, foi necessário
adotar medidas para aplicações em larga escala, dado que a base submissões do
popcon ultrapassou a marca de 100.000 usuário, o que torna o processamento de
todas as distância par-a-par extremamente custosa.

\subsection{Híbridas}

No sentido de refinar as recomendações produzidas através das estratégias
colaborativas e baseadas em conteúdo, algumas implementações híbridas foram
experimentadas. Além das listas de pacotes provenientes do \textit{Popcon} e
informações do \textit{Debtags}, outros fatores foram considerados para
composição das sugestões, alguns dos quais são descritos abaixo.

\begin{itemize}
  \item \textbf{Áreas de interesse do usuário:} a composição de um perfil de
    usuário que indique suas áreas de interesse poderia refinar as sugestões e
    diminuir a ocorrência de anomalias como, por exemplo, a indicação de
    bibliotecas de desenvolvimento de software para um usuário que não é
    programador;
  \item \textbf{Popularidade dos pacotes:} aplicativos que figuram entre os mais
    populares no \textit{Popcon} poderiam receber maior pontuação nos cálculos
    de relevância, ainda que como critério de desempate;
  \item \textbf{Bugs:} muitos relatórios de erro abertos para uma pacote são um
    indicativo de problema, principalmente se forem \textit{bugs} graves.
    Devido ao número reduzido de pacotes em cada recomendação, deve-se dar
    prioridade à incluir aqueles que recebem atenção constante de seu
    mantenedor.
\end{itemize}

\hspace{1cm}A consideração de um perfil de usuário caracteriza a estratégia com
base em dados demográficos, enquanto que popularidade e \textit{bugs} abertos
podem ser entendidos como uma modelagem de reputação dos itens. Ambas as
estratégias podem ser utilizadas para refinar os resultados obtidos com os
recomendadores básicos, caracterizando uma hibridização em \textit{cascata}
(ver seção \ref{sec:estrategias_hibrida}).

\hspace{1cm}Neste contexto é possível também produzir recomendações de forma
colaborativa com base em conteúdo, o que caracteriza um sistema híbrido
\textit{meta-nível}. Em vez de a identidade dos usuários ser representada
por uma lista de itens, seria representada pela caracterização destes itens. No caso dos pacotes, a estratégia colaborativa seria realizada a partir das
\textit{tags} dos pacotes e não das listas de pacotes originais.

\hspace{1cm}Outra possibilidade seria a elaboração de estratégias para
\textit{revezamento} entre os sistemas básicos, de acordo com o resultado do
processo de seleção de atributos. O recomendador híbrido neste caso analisaria
as características dos dados que seriam a entrada do algoritmo de recomendação
e escolheria a técnica que melhor se adequaria a esta entrada.

\hspace{1cm}Por fim, a hibridização por \textit{combinação} teria implementação
trivial dado que os recomendadores básicos já existissem, pois consiste
basicamente na apresentação em conjunto dos resultados de múltiplos
recomendadores. De certa forma, a combinação vai acontecer na apresentação do
\textit{survey} para o usuário.

\begin{table}[h!]
  \caption{Descrição das estratégias de recomendação implementadas}
  \label{tab:modelos_recomendadores}
  \centering
  \newcommand\T{\rule{0pt}{2.8ex}}
  \newcommand\B{\rule[-1.8ex]{0pt}{0pt}}
  \begin{tabular}{| l | l |}
    \hline
    Identificador & Estratégia  \T\B\\
    \hline
    ct & baseada em conteúdo utilizando tags  \T\B\\
    \hline
    cta & baseada em conteúdo utilizando tags via apt-xapian-index  \T\B\\
    \hline
    cp & baseada em conteúdo utilizando descrição de pacotes  \T\B\\
    \hline
    col & colaborativa nomes de pacotes como conteúdo \T\B\\
    \hline
    colct & colaborativa utilizando tags como conteúdo \T\B\\
    \hline
    colcp & colaborativa utilizando descrição de pacotes como conteúdo\T\B\\
    \hline
  \end{tabular}
\end{table}

\section{Codificação}

O desenvolvimento do \emph{AppRecommender} foi majoritariamente realizado na
linguagem de programação \textit{Python}\footnote{\url{http://www.python.org/}},
principalmente pela facilidade de integração com outras ferramentas do Debian
também desenvolvidas nesta linguagem. Ademais, a vasta documentação e grande
variedade de bibliotecas de utilidade para o trabalho, a exemplo da
\textit{Python-cluster}\footnote{\url{http://python-cluster.sourceforge.net/}}
e \textit{Xapian}\footnote{\url{http://xapian.org/}}, são fatores que
contribuíram para esta escolha.

O código-fonte está licenciado pela GNU GPL e disponível em um repositório
público\footnote{\url{http://github.com/tassia/AppRecommender}}. O
desenvolvimento obedeceu ao guia de estilo para código em
python\footnote{\url{http://www.python.org/dev/peps/pep-0008/}}, fez uso de
testes automatizados e padrões de projeto. A documentação é automaticamente
gerada pelo Doxygen\footnote{\url{http://www.stack.nl/~dimitri/doxygen/}} e
pode ser acessada no apêndice A deste documento. O diagrama UML do sistema está
representado na figura \ref{fig:uml_apprec}.
% FIXME [incluir referência real da documentacao]

\begin{landscape}
\begin{figure}[ht]
\resizebox{\linewidth}{!}{
  \beginpgfgraphicnamed{app_rec}
  \input{Figures/uml_apprec.tex}
  \endpgfgraphicnamed
}
\caption{Diagrama UML do AppRecommender}
\label{fig:uml_apprec}
\end{figure}
\end{landscape}
